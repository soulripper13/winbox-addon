#!/usr/bin/with-contenv bashio

# Set log level from config
bashio::log.level "$(bashio::config 'log_level')"

bashio::log.info "Setting up VNC"

# Handle VNC password from add-on options
PASSWORD=$(bashio::config 'vnc_password')
if bashio::config.has_value 'vnc_password'; then
    echo "$PASSWORD" > /root/.vnc/passwd
    chmod 600 /root/.vnc/passwd
    SECURITY="-rfbauth /root/.vnc/passwd"
else
    SECURITY="-SecurityTypes None"
fi

# Export SECURITY for supervisord to use
export SECURITY
